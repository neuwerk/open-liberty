<?xml version="1.0"?>

<!--  1.1.1.10, 4/1/10

        Description: Build file for the handlerchain/checkdefaults test.

        Date        Author       Feature/Defect          Description
        07/20/2006  euzunca      LIDB3296.31.01          new File
        08/11/2006  euzunca      LIDB3296.31.01          combine ibm with sun
        01/11/2007  btiffany                             rewrite to separate targets for ea. server, client, port to ibm
        03/23/2007  btiffany                             add tests for relative path and http path to handlers.
        08/01/2007  btiffany     455216                  change from entity refs to import statement
		09/04/2007  btiffany     461165                  compile support classes if needed.
        04/01/2010  jtnguyen     646143                  change xjc parameter to destdir
-->

<project name="build" default="buildall" basedir=".">
  <import file="../../../xmls/common_imports.xml" />


        <property name="componentName"
                value="annotations/handlerchain/checkdefaults/test" />

        <property name="warname" value="HandlerChainCheckDefaults" />

        <path id="componentClasspath">
                <path refid="thinclientclasspath" />
        </path>
		
		        <uptodate property="supportBuild.notRequired" targetfile=			"${FVT.base.dir}/build/classes/annotations/support/Support.class" >
                <srcfiles dir= "${FVT.base.dir}/src/annotations/support" includes="**/*.java"/>
        </uptodate>

        <!-- <target name="buildall" depends="descope" /> -->
        <target name="buildall" depends="setenv, clean, init, compileSupport, server1, client1, server2, client2, server3, client3, server4, client4, server5, client5, server6, test" />

        <target name="descope">
            <echo message="this function is not active because it has been descoped" />
        </target>
        <target name="clean" depends="setenv">
                <delete dir="${FVT.build.classes.dir}/annotations/handlerchain/checkdefaults" />
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults" />
                <delete dir="${FVT.build.lib.dir}/addnumbers.war" />
                <delete>
                    <fileset dir="${FVT.build.lib.dir}" includes="${warname}*war" />
                </delete>
                <delete>
                    <fileset dir="${FVT.build.installableApps.dir}" includes="${warname}*ear"/>
                </delete>
        </target>


        <target name="init" depends="setenv">
                <antcall target="component-init" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults" />
        </target>
		
        <!-- compile annotations/support package -->
        <target name="compileSupport" depends="setenv" unless="supportBuild.notRequired">
                <javac compiler="modern" srcdir="${FVT.base.dir}/src/annotations/support"
                        destdir="${FVT.build.classes.dir}"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                        target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath refid="classpath" />
                </javac>
        </target>


        <!-- let's change this to 4 server targets -->
        <target name="server1" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"/>
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"/>
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                        source="${build.tests.with.java.level}"
                        target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">

                        <include name="**/server1/*.java"/>
                        <include name="**/common/*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>

                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server1/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>
                <war warfile="${FVT.build.lib.dir}/${warname}1.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server1/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                        <!-- toss in the src -->
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server1" >
                                <include name="**/*java" />
                        </classes>
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common" >
                                <include name="**/*java" />
                        </classes>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}1.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server1/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}1.war"/>
                </ear>

        </target>


        <target name="server2" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"/>
                <delete file="${FVT.build.installableApps.dir}/${warname}2.ear" />
                <delete file="${FVT.build.lib.dir}/${warname}2.war" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"/>
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                	    source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">

                        <include name="**/server2/*.java"/>
                        <include name="**/common/*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>


                <!-- dev. says we have to have obj fac. for doc lit bare now... 409137.3 -->
                <!-- generate package-info and objectfactory from wsdl here -->
                <echo message="--xjc--" />
                <xjc destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2" >
                     <arg value="-wsdl" />
                     <schema dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2" includes="*.wsdl" />
                </xjc>
                <!-- leaves a bit of a mess, beans and support files are now present twice,
                     from xjc in target-dir, and from wsgen in target-dir/jaxws.
                     However the ones from xjc are not compiled.

                     ObjectFactory.java does not contain an import statement for the jaxws
                     package, so we have to throw away the wsgen beans and use the xjc beans
                     instead.
                -->

                <delete verbose="true">
                   <fileset dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2"
                       includes="**/jaxws/*"
                   />
                </delete>

                <!-- now we have to compile the xjc beans, sheesh... -->

                <property name="workdir_imp" value="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2" />
                <javac compiler="modern" srcdir="${workdir_imp}"
                       destdir="${workdir_imp}"
                       deprecation="${deprecation}"
                       debug="${debug}"
                       source="${build.tests.with.java.level}"
                       target="${build.tests.with.java.level}"
                       failonerror="${failonerror}">
                       <classpath>
                          <dirset dir="${workdir_imp}" />
                          <path refid="thinclientclasspath" />
                       </classpath>
                       <include name="**/*java"/>
                </javac>


                <!-- copy in the handler config file which we'll try to read later -->
                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server2/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>




                <war warfile="${FVT.build.lib.dir}/${warname}2.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server2/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                        <!-- toss in the src -->
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server2" >
                                <include name="**/*java" />
                        </classes>
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common" >
                                <include name="**/*java" />
                        </classes>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}2.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server2/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}2.war"/>
                </ear>

        </target>


        <target name="server3" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"/>
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"/>
                <delete file="${FVT.build.installableApps.dir}/${warname}3.ear" />
                <delete file="${FVT.build.lib.dir}/${warname}3.war" />
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                        source="${build.tests.with.java.level}"
                        target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">

                        <include name="**/server3/*.java"/>
                        <include name="**/common/*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>

                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server3/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>
                <war warfile="${FVT.build.lib.dir}/${warname}3.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server3/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                        <!-- toss in the src -->
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server3" >
                                <include name="**/*java" />
                        </classes>
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common" >
                                <include name="**/*java" />
                        </classes>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}3.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server3/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}3.war"/>
                </ear>

        </target>


        <target name="server4" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"/>
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"/>
                <delete file="${FVT.build.installableApps.dir}/${warname}4.ear" />
                <delete file="${FVT.build.lib.dir}/${warname}4.war" />
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">

                        <include name="**/server4/*.java"/>
                        <include name="**/common/*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>

                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server4/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>
                <war warfile="${FVT.build.lib.dir}/${warname}4.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server4/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                        <!-- toss in the src -->
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server4" >
                                <include name="**/*java" />
                        </classes>
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common" >
                                <include name="**/*java" />
                        </classes>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}4.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server4/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}4.war"/>
                </ear>

        </target>


        <!-- identical to server4 but with . and .. in the handler path, and a different protocol -->
        <target name="server5" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"/>
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"/>
                <delete file="${FVT.build.installableApps.dir}/${warname}5.ear" />
                <delete file="${FVT.build.lib.dir}/${warname}5.war" />
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">

                        <include name="**/server5/*.java"/>
                        <include name="**/common/*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>

                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server5/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>
                <war warfile="${FVT.build.lib.dir}/${warname}5.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server5/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                        <!-- toss in the src -->
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server5" >
                                <include name="**/*java" />
                        </classes>
                        <classes dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common" >
                                <include name="**/*java" />
                        </classes>

                        <!-- put the xml file from server6 at the root of the war so it's reachable via http
                             server6 will use this to test ability to retrieve a handler file over http
                        -->

                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6/etc" >
                               <include name="handlers*.xml" />
                        </fileset>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}5.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server5/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}5.war"/>
                </ear>

        </target>

        <target name="client5" depends="setenv">

                <!-- build each client in it's own dir so we can use different wsimport artifacts.
                  These occur because we use  different soap message types, which produce slightly differing wsdl's. -->

                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client5" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client5" />

                <wsimport keep="true" verbose="true" extension="true"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client5"
                        wsdl="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server5/AddNumbersImplService.wsdl">
                </wsimport>

                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/client2"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client5"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath>
                              <path refid="classpath"/>
                              <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client5" />
                        </classpath>
                        <include name="**/*.java" />
                </javac>
        </target>

        <!-- identical to server4 but with handler reached via http -->
        <!-- TODO: web-ify the handler file and transform the impl class before compile. -->
        <target name="server6" depends="setenv">
                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"/>
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"/>
                <delete file="${FVT.build.installableApps.dir}/${warname}6.ear" />
                <delete file="${FVT.build.lib.dir}/${warname}6.war" />

                <!-- this task injects Cell properties into ant so we can get the host and port -->
                <readCellConfig prefix="server1" key="defaultServer" verbose="false" />

                <!-- copy the source to the workdir so we can mangle it -->
                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6">
                                <include name="*java" />
                        </fileset>
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/common">
                                <include name="*java" />
                        </fileset>
                </copy>

                <!-- inject the correct host and port -->
                <replace file="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6/AddNumbersImpl.java"
                        token="@HOST_AND_PORT@"
                        value="http://${server1.hostName}:${server1.WC_defaulthost}"
                />

                <javac compiler="modern"
                        srcdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        verbose="false"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <include name="*.java"/>
                        <classpath refid="classpath" />
                </javac>

                <echo message="wsgen..." />
                <!-- we won't package this, but will use it later for the client -->
                <wsgen genwsdl="true" keep="true" verbose="false"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                        resourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                        sourcedestdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"
                        sei="annotations.handlerchain.checkdefaults.server.AddNumbersImpl"
                        >
                      <classpath>
                            <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6"/>
                            <path refid="classpath"/>
                      </classpath>
                </wsgen>

                <!--
                <copy todir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6/annotations/handlerchain/checkdefaults/server"
                      verbose="true" overwrite="yes">
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6/etc">
                                <include name="handlers*.xml" />
                        </fileset>
                </copy>
                -->
                <war warfile="${FVT.build.lib.dir}/${warname}6.war"
                        webxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/etc/web.xml">

                        <!-- put the xml file at the root of the war so it's reachable via http -->
                        <fileset dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6/etc" >
                               <include name="handlers*.xml" />
                        </fileset>
                        <webinf dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6/etc">
                                <include name="${vendor.binding.file}" />   <!-- give another impl's name here if that's the target impl -->
                        </webinf>
                        <classes dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server6">
                                <include name="**/*.class" />
                                <include name="**/*.java" />
                                <include name="**/*.xml" />
                        </classes>
                </war>
                <ear earfile="${FVT.build.installableApps.dir}/${warname}6.ear"
                      appxml="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/server6/etc/application.xml">
                      <fileset dir="${FVT.build.lib.dir}" includes="${warname}6.war"/>
                </ear>

        </target>


        <target name="client1" depends="setenv">

                <!-- build each client in it's own dir so we can use different wsimport artifacts.
                  These occur because we use  different soap message types, which produce slightly differing wsdl's. -->

                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client1" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client1" />

                <wsimport keep="true" verbose="true" extension="true"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client1"
                        wsdl="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server1/AddNumbersImplService.wsdl">
                </wsimport>

                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/client"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client1"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath>
                              <path refid="classpath"/>
                              <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client1" />
                        </classpath>
                        <include name="**/*.java" />
                </javac>
        </target>


        <!-- this one is truly different, unique method sig. to work around doc lit bare limitation -->
        <target name="client2" depends="setenv">

                <!-- build each client in it's own dir so we can use different wsimport artifacts.
                  These occur because we use  different soap message types, which produce slightly differing wsdl's. -->

                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client2" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client2" />

                <wsimport keep="true" verbose="true" extension="true"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client2"
                        wsdl="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server2/AddNumbersImplService.wsdl">
                </wsimport>

                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/client2"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client2"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath>
                              <path refid="classpath"/>
                              <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client2" />
                        </classpath>
                        <include name="**/*.java" />
                </javac>
        </target>


        <target name="client3" depends="setenv">

                <!-- build each client in it's own dir so we can use different wsimport artifacts.
                  These occur because we use  different soap message types, which produce slightly differing wsdl's. -->

                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client3" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client3" />

                <wsimport keep="true" verbose="true" extension="true"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client3"
                        wsdl="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server3/AddNumbersImplService.wsdl">
                </wsimport>

                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/client"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client3"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath>
                              <path refid="classpath"/>
                              <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client3" />
                        </classpath>
                        <include name="**/*.java" />
                </javac>
        </target>


        <target name="client4" depends="setenv">

                <!-- build each client in it's own dir so we can use different wsdl's with different soap message types -->

                <delete dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client4" />
                <mkdir dir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client4" />

                <wsimport keep="true" verbose="true" extension="true"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client4"
                        wsdl="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/server4/AddNumbersImplService.wsdl">
                </wsimport>

                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/client2"
                        destdir="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client4"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath>
                              <path refid="classpath"/>
                              <pathelement path="${FVT.build.work.dir}/annotations/handlerchain/checkdefaults/client4" />
                        </classpath>
                        <include name="**/*.java" />
                </javac>
        </target>


        <target name="test" depends="setenv">
                <javac compiler="modern"
                        srcdir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults"
                        destdir="${FVT.build.classes.dir}"
                        deprecation="${deprecation}"
                        debug="${debug}"
                        source="${build.tests.with.java.level}"
                	    target="${build.tests.with.java.level}"
                        failonerror="${failonerror}">
                        <classpath refid="classpath" />
                        <include name="**/test/*.java" />
                </javac>
        </target>


          <target name="preinstall" depends="setenv">
          </target>

          <target name="install" depends="setenv">
            <ant antfile="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/installTest.xml"
                 dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults">
            </ant>
          </target>

          <target name="uninstall" depends="setenv">
            <ant antfile="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults/uninstallTest.xml"
                 dir="${FVT.base.dir}/src/annotations/handlerchain/checkdefaults">
            </ant>
          </target>

          <target name="testAll">
            <antcall target="runTests">
              <param name="cp" value="classpath"/>
              <param name="logs.dir" value="${FVT.logs.dir}"/>
              <param name="reports.dir" value="${FVT.test.reports.dir}"/>
            </antcall>
                <antcall target="genReports" />
          </target>

</project>
