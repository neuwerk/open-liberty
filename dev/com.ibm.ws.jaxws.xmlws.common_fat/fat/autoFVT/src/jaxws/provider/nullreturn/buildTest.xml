<?xml version="1.0" encoding="UTF-8"?>
<!--  1.2, 5/20/11
    Date        Author       Feature/Defect          Description
    06/28/2010  btiffany      F743-23021             new file
    05/20/2011  jtnguyen      667709.2               not to delete other files in build/work
  
-->

<project basedir="." default="buildall" >
	 <import file="../../../xmls/common_imports.xml"/>

	<property name="componentName" value="jaxws/provider/nullreturn"/>

	<property name="test.base.dir" value="${FVT.base.dir}/src/${componentName}" />
	<property name="test.work.dir" value="${FVT.build.work.dir}/${componentName}" />	
	
	  <!-- This path id is used in the targets.xml file when running any of
       the component-run* targets.  This allows setting the classpath 
       for an individual test.
	  -->
	<path id="componentClasspath">
	  <path refid="thinclientclasspath"/>
	</path>
		

	<target name="buildall" depends="clean, init, server, client, test" /> 
  
	<target name="clean" depends="setenv">
		<echo message="Cleaning..." />
		<delete dir="${FVT.build.work.dir}/${componentName}" />
		<delete dir="${FVT.build.classes.dir}/${componentName}" />
	</target>
	
	<target name="init" depends="setenv">
		<echo message="Initializing..." />
		<mkdir dir="${FVT.build.classes.dir}"/>
		<mkdir dir="${FVT.build.lib.dir}"/>
		<mkdir dir="${FVT.build.installableApps.dir}"/>			
		<mkdir dir="${test.work.dir}"/>			
	</target>
	
	<target name="server" depends="setenv">
		<echo message="Building Server..." />
	
		<javac compiler="modern" srcdir="${FVT.base.dir}/src/jaxws/provider/nullreturn/server"
	           destdir="${FVT.build.classes.dir}"           
	           deprecation="${deprecation}"
	           debug="${debug}"
       	       source="${build.tests.with.java.level}"
       	       target="${build.tests.with.java.level}"
	           failonerror="${failonerror}">
	      <classpath refid="classpath"/>
	      <include name="**/*.java"/>
	    </javac>  
	
	    <delete file="${FVT.build.lib.dir}/nullprovidernowsdl.war" />
	    <delete file="${FVT.build.lib.dir}/nullproviderwsdl.war" />
	    <delete file="${FVT.build.lib.dir}/nullproviderwsdlnoresp.war" />
	
	 	<war destfile="${FVT.build.lib.dir}/nullprovidernowsdl.war"
			  webxml="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/common/web.xml">
			<zipfileset dir="${FVT.base.dir}/src"
				includes="jaxws/provider/nullreturn/server/nowsdl/*.java"
				prefix="WEB-INF/classes" />		
			<classes dir="${FVT.build.classes.dir}">			
				<include name="jaxws/provider/nullreturn/server/nowsdl/**/*.class" />			
			</classes>
		</war>
		
	 	<war destfile="${FVT.build.lib.dir}/nullproviderwsdl.war"
			  webxml="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/common/web.xml">
			<zipfileset dir="${FVT.base.dir}/src"
				includes="jaxws/provider/nullreturn/server/wsdl/*.java"
				prefix="WEB-INF/classes" />		
			<zipfileset dir="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/wsdl"
				includes="*wsdl,*xsd"
				prefix="WEB-INF/wsdl" />			
			<classes dir="${FVT.build.classes.dir}">			
				<include name="jaxws/provider/nullreturn/server/wsdl/**/*.class" />			
			</classes>
		</war>
		
	 	<war destfile="${FVT.build.lib.dir}/nullproviderwsdlnoresp.war"
			  webxml="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/common/web.xml">
			<zipfileset dir="${FVT.base.dir}/src"
				includes="jaxws/provider/nullreturn/server/wsdlnoresp/*.java"
				prefix="WEB-INF/classes" />		
			<zipfileset dir="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/wsdlnoresp"
				includes="*wsdl,*xsd"
				prefix="WEB-INF/wsdl" />		
			<classes dir="${FVT.build.classes.dir}">			
				<include name="jaxws/provider/nullreturn/server/wsdlnoresp/**/*.class" />			
			</classes>
		</war>
	
		<delete file="${FVT.build.installableApps.dir}/nullprovider.ear"/>
		<ear earfile="${FVT.build.installableApps.dir}/nullprovider.ear"
		     appxml="${FVT.base.dir}/src/jaxws/provider/nullreturn/server/common/application.xml">
			<fileset dir="${FVT.build.lib.dir}" includes="nullprovider*.war" />		
		</ear>	
		
	</target>

	<target name="client" />
	
	<target name="test">	
		<echo message="Building Tests..." />

        <javac compiler="modern"
            fork="true"
            srcdir="${test.base.dir}"
            destdir="${FVT.build.classes.dir}"
            source="${build.tests.with.java.level}"
            target="${build.tests.with.java.level}"
            includes="**/test/**/*.java,**/client/**/*.java">
            <classpath>
				<path refid="classpath"/>
			</classpath>
        </javac>		
	</target>
	
	<target name="install" depends="setenv">
		<ant antfile="${FVT.base.dir}/src/${componentName}/installTest.xml"
			 dir="${FVT.base.dir}/src/${componentName}">
			<property name="install.mode" value="${rt.install.mode}"/>
		</ant>
  </target>
        
  <target name="uninstall" depends="setenv">
    <ant antfile="${FVT.base.dir}/src/${componentName}/uninstallTest.xml"
         dir="${FVT.base.dir}/src/${componentName}">
      <property name="uninstall.mode" value="${rt.uninstall.mode}"/>
    </ant>
  </target>

</project>
