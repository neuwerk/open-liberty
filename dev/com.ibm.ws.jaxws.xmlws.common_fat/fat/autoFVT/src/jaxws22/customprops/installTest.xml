<?xml version="1.0"?>                     
<!DOCTYPE project [
		<!ENTITY instance SYSTEM "../../../instance.xml"><!-- file:28 -->
		<!ENTITY properties SYSTEM "../../xmls/properties.xml"><!-- file:30 -->
		<!ENTITY targets SYSTEM "../../xmls/targets.xml"><!-- file:27 -->
		<!ENTITY taskdefs SYSTEM "../../xmls/taskdefs.xml"><!-- file:28 -->
		<!ENTITY taskdefs_post_compile SYSTEM "../../xmls/taskdefs_post_compile.xml"><!-- file:41 -->
		<!ENTITY path_refs SYSTEM "../../xmls/path_refs.xml"><!-- file:29 -->
]>

<!--   1.1, 12/15/10

     Description: Build file for the custom properties in V8
     
     Date        Author       Feature/Defect            Description
     12/07/2010  jtnguyen     F743-23362                new file
-->


<project default="install" basedir=".">
   
   
  <!-- These are XML entity refs.  Basically these statements cause the
       files declared in the DOCTYPE at the top of the file to be imported
       into this build file.
  -->   
  &instance;
  &properties;
  &path_refs;
  &taskdefs;
  &taskdefs_post_compile;
  &targets;

  <!-- The install target will install the EAR or WAR file into WebSphere, and copy keys and new policy sets to server side
  -->
  <target name="install" depends="setenv">

    <!-- copy KEYSTORE FILES to app server's ws-security/samples directory:
        we need files from <WAS.base.dir>/etc/ws-security/samples 
        to be in <root.profileDir>/etc/ws-security/samples, where root.profileDir = app server
        run readCellConfig with key="defaultServer" -->

  	<!-- <readCellConfig prefix="root" key="defaultServer" verbose="true"/>-->

  	
  	<!-- 
   <echo message="Copying KEYSTORE FILES to app server profile's etc/ws-security/samples"/>
   <mkdir dir="${root.profileDir}/etc/ws-security/samples"/>
   
   <copy todir="${root.profileDir}/etc/ws-security/samples" overwrite="yes">
       <fileset dir="${WAS.base.dir}/etc/ws-security/samples">
           <include name="*"/>
       </fileset>
   </copy>
-->
   <!-- define key=root, to copy files to dmgr directory if this is ND -->                                                                                 
  	<!--<readCellConfig prefix="root" key="root" verbose="true"/>  -->
   
    
   <!-- copy KEYSTORE FILES to dmgr's ws-security/samples, root.profileDir = dmgr -->
  	<!--     
   <echo message="Copying KEYSTORE FILES to dmgr profile's etc/ws-security/samples"/>
   <mkdir dir="${root.profileDir}/etc/ws-security/samples"/>
   
   <copy todir="${root.profileDir}/etc/ws-security/samples" overwrite="yes">

       
       <fileset dir="${WAS.base.dir}/etc/ws-security/samples">
           <include name="*"/>
       </fileset>
   </copy>

  	-->
   
   <!-- policy set = CustomProps_PS -->    
   
   
   <!-- Copy new policy sets to Websphere's PolicySet directory -->
   <echo message="Copying new policy sets to WAS directory ${root.profileDir}/config/cells/${root.cellName}/PolicySets/CustomProps_PS"/>  
   
   <mkdir dir="${root.profileDir}/config/cells/${root.cellName}/PolicySets/CustomProps_PS/PolicyTypes/WSSecurity"/>
   
   <copy todir="${root.profileDir}/config/cells/${root.cellName}/PolicySets/CustomProps_PS" overwrite="yes">
       <fileset dir="${FVT.base.dir}/src/jaxws22/customprops/wsfvt/server/PolicySets/CustomProps_PS">
           <include name="policySet.xml"/>
       </fileset>
   </copy>
            
   <copy todir="${root.profileDir}/config/cells/${root.cellName}/PolicySets/CustomProps_PS/PolicyTypes/WSSecurity" overwrite="yes">
       <fileset dir="${FVT.base.dir}/src/jaxws22/customprops/wsfvt/server/PolicySets/CustomProps_PS/PolicyTypes/WSSecurity">
           <include name="policy.xml"/>
       </fileset>
   </copy>
            
            

    <InstallApp earName="CustomProps.ear"
                appName="CustomProps"
                localInstall="${conn.type}"
                useDefaultBindings="true"
                installRootLocation="${FVT.build.installableApps.dir}"
                installMode="${install.mode}"
                fvtRootLocation="${FVT.base.dir}">
    </InstallApp>

   
  </target>
  
</project>

